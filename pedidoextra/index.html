<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <script>
    // Redireciona imediatamente se tentar acessar direto
    if (document.referrer === "" || document.referrer === window.location.href) {
      window.location.replace("https://almoxarifadobotucatu.netlify.app/");
    }

    function preencherUnidadeControle(itemSelecionado, unidadeControleInput) {
      const match = itemSelecionado.match(/unidade:\s*([A-Za-zÀ-ú]+)/i);
      if (match) {
          unidadeControleInput.value = match[1];
      } else {
          unidadeControleInput.value = "";
      }
    }
  </script>

  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Solicitação de Pedido Extra</title>

  <style>
    /* estilos originais mantidos */
    body { background:#1a1a2e; font-family:'Inter',sans-serif; color:#fff; }
    .container { max-width:800px; margin:40px auto; padding:50px; background:#16213e; border-radius:20px; }
    label { display:block; margin-top:20px; margin-bottom:5px; }
    input[type="text"] { width:100%; padding:14px 18px; border:1px solid #2a2a3a; border-radius:12px; background:rgba(255,255,255,0.1); color:#fff; }
    .buttons { margin-top:30px; display:flex; justify-content:center; gap:20px; }
    button { background:#0a66c2; color:#fff; border:none; padding:14px 30px; border-radius:12px; cursor:pointer; font-weight:600; }
    #mensagensErros { display:none; margin:15px 0; padding:15px; border:1px solid #ff4d4d; border-radius:8px; background:#ffe5e5; color:#a70000; }
  </style>
</head>
<body oncontextmenu="return false;">
  <div class="container" id="mainContainer">
    <h2>Solicitação de Pedido Extra</h2>
    <div id="mensagensErros"></div>

    <form id="pedidoForm" novalidate onsubmit="return false;">
      <label for="solicitante">Responsável pela solicitação:</label>
      <input autocomplete="off" id="solicitante" type="text"/>

      <label for="unidade">Unidade de saúde:</label>
      <input autocomplete="off" id="unidade" type="text"/>

      <div id="setoresContainer"></div>
      <div class="buttons">
        <button onclick="adicionarSetor()" type="button">Adicionar novo setor</button>
        <button id="enviarPedido" type="button" onclick="if(validarFormulario()){ enviarPedido(); }">Enviar pedido</button>
      </div>
    </form>
  </div>

  <datalist id="lista-itens"></datalist>
  <script>
    function validarFormulario(){
      const erros = [];
      const solicitante = document.getElementById("solicitante");
      const unidade = document.getElementById("unidade");
      if(solicitante.value.trim()==="") erros.push("Preencha o responsável pela solicitação.");
      if(unidade.value.trim()==="") erros.push("Preencha a unidade de saúde.");

      const msg = document.getElementById("mensagensErros");
      if(erros.length>0){
        msg.style.display="block";
        msg.innerHTML = "<h3>Corrija os erros abaixo:</h3><ul><li>" + erros.join("</li><li>") + "</li></ul>";
        return false;
      }
      msg.style.display="none";
      return true;
    }

    function enviarPedido(){
      alert("Pedido enviado com sucesso!");
    }
  </script>
</body>
</html>
